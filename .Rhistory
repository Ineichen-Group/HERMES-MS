MRI_EAE_ES_plot<-ES_df_trial2 %>%
ggplot(aes(y = rank2, x = yi))+
geom_segment(aes(y=rank2,yend=rank2,x=-3.5,xend=30),color="#f1f1f1",linewidth=0.4)+
geom_point(aes(fill=color,color=color,shape=color,alpha=color,size=color))+
geom_segment(aes(y=rank2,yend=rank2,x=upper_CI,xend=lower_CI),color="#222222")+
geom_label(data = . %>% filter(grepl("Median",Name)),aes(label=Name,x=-4),label.size = NA,hjust=1,fontface="bold")+
geom_label(data = . %>% filter(!(grepl("Median",Name))),aes(label=Name,x=-4),label.size = NA,hjust=1)+
labs(x = "Tested Drugs", y = "Effect Size") +
theme_minimal()+
theme(axis.title = element_blank(),
axis.text.x = element_text(size=14),
axis.text.y = element_blank(),
panel.grid.major.y =element_blank(),
panel.grid.minor.y =element_blank(),
strip.background = element_rect(fill="#e8eae7",color="#cbccca"),
panel.grid.minor.x =element_blank(),
legend.title = element_blank(),
strip.text = element_text(size=14),
legend.text = element_text(size=12),
legend.position = "bottom")+
scale_color_manual(values=c("Approved"="#567ca7", "Failed"="#d0645e","overall"="#222222"),breaks=c("Approved","Failed"))+
scale_fill_manual(values=c("Approved"="#6896ca", "Failed"="#ff7b74","overall"="#222222"),breaks=c("Approved","Failed"))+
scale_alpha_manual(values=c("Approved"=0.75, "Failed"=0.75,"overall"=1),breaks=c("Approved","Failed"))+
scale_shape_manual(values=c("Approved"=21, "Failed"=21,"overall"=23),breaks=c("Approved","Failed"))+
scale_size_manual(values=c("Approved"=4, "Failed"=4,"overall"=2),breaks=c("Approved","Failed"))+
scale_y_reverse()+
scale_x_continuous(breaks=c(0,10,20))+
facet_wrap(.~item,ncol=1,scales = "free_y",strip.position="right")+
force_panelsizes(rows = c(1,0.30)) +
coord_cartesian(xlim=c(-20,NA))
ggsave("MRI_EAE_ES_plot.png",MRI_EAE_ES_plot,height = 29/3,width = 21/3,bg = "white")
library(DiagrammeR)
library(RColorBrewer)
library(dplyr)
library(tidyr)
library(scales)
library(gridExtra)
library(forcats)
library(readxl)
library(ggpubr)
library(ggplot2)
library(purrr)
library(ggbeeswarm)
library(cowplot)
library(stringr)
library(ggh4x)
library(metafor)
library(ggpubr)
figure_panel3
grid.arrange(plot_row1,plot_row2,
p3+ggtitle(bquote(bold("E.")~"Tested drugs"))+
theme(legend.position = "bottom",
legend.text = element_text(size=13,color="gray20")),
ncol=1,heights=c(1,1,1.5))
df_row1<-rbind(HERMES_INCLUDED%>%
mutate(Species=gsub("mosue","mouse",Species)) %>%
group_by(Species) %>%
summarise(Frequency = n()) %>%
ungroup() %>%
mutate(Species=str_to_title(ifelse(Frequency<=5,"Other",Species))) %>%
group_by(Species) %>%
summarise(Frequency=sum(Frequency)) %>%
mutate(item="A. Species") %>%
rename(Category=Species,n=Frequency),
HERMES_INCLUDED %>%
group_by(Animal.model) %>%
summarise(Frequency = n()) %>%
mutate(Animal.model=str_split(Animal.model, ',')) %>%
unnest(Animal.model) %>%
mutate(Animal.model=trimws(Animal.model)) %>%
ungroup() %>%
group_by(Animal.model) %>%
summarise(Frequency = sum(Frequency)) %>%
mutate(Animal.model=ifelse(Frequency<=5,"Other",Animal.model)) %>%
ungroup() %>%
group_by(Animal.model) %>%
summarise(Frequency = sum(Frequency)) %>%
mutate(Animal.model=case_when(
Animal.model=="cuprizone"~"Cuprizone",
Animal.model=="lysolecithin"~"Lysolecithin",
Animal.model=="ethidium bromide"~"Ethidium bromide",
TRUE~Animal.model
))%>%
mutate(item="B. Animal model") %>%
rename(Category=Animal.model,n=Frequency))
labels_row1<-list("A. Species"=bquote(bold("A.")~"Species"),"B. Animal model"=bquote(bold("B.")~"Animal model"))
labeller_row1 <- function(variable,value){
return(labels_row1[value])}
plot_row1<-
df_row1%>%
ggplot(aes(x = reorder(Category, -n), y = n)) +
geom_bar(stat = "identity", fill = "#b6b6b6",color="#929292") +
labs(x = "Animal Model", y = "Number of studies") +
ylim(0, 440) +
common_theme+
facet_wrap(.~item,scales = "free_x",labeller = labeller_row1)+
theme(
strip.text.x = element_text(hjust=0,size=12),
panel.spacing = unit(1.5, "lines"))
df_row2<-rbind(HERMES_INCLUDED %>%
mutate(Sex=str_to_title(gsub("\\bboth\\b","both sexes",Sex))) %>%
group_by(Sex) %>%
summarise(Frequency = n()) %>%
ungroup() %>%
mutate(Sex=gsub("Na",NA,Sex))%>%
mutate(item="C. Sex") %>%
rename(Category=Sex,n=Frequency),
HERMES_INCLUDED %>%
group_by(Strain) %>%
summarise(Frequency = n()) %>%
mutate(Strain=str_split(Strain, ',')) %>%
unnest(Strain) %>%
mutate(Strain=trimws(Strain)) %>%
ungroup() %>%
group_by(Strain) %>%
summarise(Frequency = sum(Frequency)) %>%
mutate(Strain=ifelse(Frequency<=5,"Other",Strain)) %>%
ungroup() %>%
group_by(Strain) %>%
summarise(Frequency = sum(Frequency)) %>%
mutate(Strain=gsub("-"," ",Strain)) %>%
mutate(item="D. Strain") %>%
rename(Category=Strain,n=Frequency))
labels_row2<-list("C. Sex"=bquote(bold("C.")~"Sex"),"D. Strain"=bquote(bold("D.")~"Strain"))
labeller_row2 <- function(variable,value){
return(labels_row2[value])}
plot_row2<-df_row2%>%
ggplot(aes(x = reorder(Category, -n), y = n)) +
geom_bar(stat = "identity", fill = "#b6b6b6",color="#929292") +
labs(x = "Animal Model", y = "Number of studies") +
ylim(0, 320) +
common_theme+
facet_grid(. ~ item,scales = "free", labeller=labeller_row2)+
theme(
strip.text.x = element_text(hjust=0,size=12),
panel.spacing = unit(1.5, "lines"))
p3<-rbind(HERMES_INCLUDED %>% group_by(Tested.drug.2,status2) %>% count() %>% rename(drugs=1,status=2),
HERMES_INCLUDED %>% group_by(Tested.drug.s.,status) %>% count() %>% rename(drugs=1,status=2)) %>%
data.frame() %>%
group_by(drugs,status) %>%
summarise(n=sum(n)) %>%
mutate(across(everything(),~ gsub("NA",NA, .))) %>%
unique() %>%
drop_na()%>%
mutate(status=ifelse(status=="Marketed","Approved drugs","Failed drugs")) %>%
mutate(n=as.numeric(n),
drugs=case_when(
drugs=="Glatiramer acetate"~"GA",
drugs=="Dimethyl fumarate"~"DMF",
drugs=="Peginterferon beta-1a"~"PEG-IFN beta-1a",
drugs=="Interferon Beta 1"~"IFN beta-1",
drugs=="Monomethyl fumarate"~"MMF",
drugs=="Epigallocatechin gallate"~"EGCG",
TRUE~drugs
)) %>%
ggplot(aes(x = reorder(drugs, -n), y = n,fill=status,color=status)) +
geom_bar(stat = "identity") +
labs(x = "Tested Drugs", y ="Number ofstudies") +
common_theme+
scale_fill_manual(values=c("Approved drugs"="#6896ca","Failed drugs"="#ff7b74"))+
scale_color_manual(values=c("Approved drugs"="#567ca7","Failed drugs"="#d0645e"))+
theme(legend.title=element_blank())
figure_panel3<-grid.arrange(plot_row1,plot_row2,
p3+ggtitle(bquote(bold("E.")~"Tested drugs"))+
theme(legend.position = "bottom",
legend.text = element_text(size=13,color="gray20")),
ncol=1,heights=c(1,1,1.5))
df_row1
df_row2
HERMES_INCLUDED %>%
mutate(Sex=str_to_title(gsub("\\bboth\\b","both sexes",Sex))) %>%
group_by(Sex) %>%
summarise(Frequency = n()) %>%
ungroup() %>%
mutate(Sex=gsub("Na",NA,Sex))%>%
mutate(item="C. Sex") %>%
rename(Category=Sex,n=Frequency),
HERMES_INCLUDED %>%
mutate(Sex=str_to_title(gsub("\\bboth\\b","both sexes",Sex))) %>%
group_by(Sex) %>%
summarise(Frequency = n()) %>%
ungroup() %>%
mutate(Sex=gsub("Na",NA,Sex))%>%
mutate(item="C. Sex") %>%
rename(Category=Sex,n=Frequency)
df_row1<-rbind(HERMES_INCLUDED%>%
mutate(Species=gsub("mosue","mouse",Species)) %>%
group_by(Species) %>%
summarise(Frequency = n()) %>%
ungroup() %>%
mutate(Species=str_to_title(ifelse(Frequency<=5,"Other",Species))) %>%
group_by(Species) %>%
summarise(Frequency=sum(Frequency)) %>%
mutate(item="A. Species") %>%
rename(Category=Species,n=Frequency),
HERMES_INCLUDED %>%
group_by(Animal.model) %>%
summarise(Frequency = n()) %>%
mutate(Animal.model=str_split(Animal.model, ',')) %>%
unnest(Animal.model) %>%
mutate(Animal.model=trimws(Animal.model)) %>%
ungroup() %>%
group_by(Animal.model) %>%
summarise(Frequency = sum(Frequency)) %>%
mutate(Animal.model=ifelse(Frequency<=5,"Other",Animal.model)) %>%
ungroup() %>%
group_by(Animal.model) %>%
summarise(Frequency = sum(Frequency)) %>%
mutate(Animal.model=case_when(
Animal.model=="cuprizone"~"Cuprizone",
Animal.model=="lysolecithin"~"Lysolecithin",
Animal.model=="ethidium bromide"~"Ethidium bromide",
TRUE~Animal.model
))%>%
mutate(item="B. Animal model") %>%
rename(Category=Animal.model,n=Frequency))
labels_row1<-list("A. Species"=bquote(bold("A.")~"Species"),"B. Animal model"=bquote(bold("B.")~"Animal model"))
labeller_row1 <- function(variable,value){
return(labels_row1[value])}
plot_row1<-
df_row1%>%
ggplot(aes(x = reorder(Category, -n), y = n)) +
geom_bar(stat = "identity", fill = "#b6b6b6",color="#929292") +
labs(x = "Animal Model", y = "Number of studies") +
ylim(0, 440) +
common_theme+
facet_wrap(.~item,scales = "free_x",labeller = labeller_row1)+
theme(
strip.text.x = element_text(hjust=0,size=12),
panel.spacing = unit(1.5, "lines"))
df_row2<-rbind(HERMES_INCLUDED %>%
mutate(Sex=str_to_title(gsub("\\bboth\\b","both sexes",Sex))) %>%
group_by(Sex) %>%
summarise(Frequency = n()) %>%
ungroup() %>%
mutate(Sex=gsub("Na",NA,Sex),Sex=gsub("Both Sexes","Both sexes",Sex))%>%
mutate(item="C. Sex") %>%
rename(Category=Sex,n=Frequency),
HERMES_INCLUDED %>%
group_by(Strain) %>%
summarise(Frequency = n()) %>%
mutate(Strain=str_split(Strain, ',')) %>%
unnest(Strain) %>%
mutate(Strain=trimws(Strain)) %>%
ungroup() %>%
group_by(Strain) %>%
summarise(Frequency = sum(Frequency)) %>%
mutate(Strain=ifelse(Frequency<=5,"Other",Strain)) %>%
ungroup() %>%
group_by(Strain) %>%
summarise(Frequency = sum(Frequency)) %>%
mutate(Strain=gsub("-"," ",Strain)) %>%
mutate(item="D. Strain") %>%
rename(Category=Strain,n=Frequency))
labels_row2<-list("C. Sex"=bquote(bold("C.")~"Sex"),"D. Strain"=bquote(bold("D.")~"Strain"))
labeller_row2 <- function(variable,value){
return(labels_row2[value])}
plot_row2<-df_row2%>%
ggplot(aes(x = reorder(Category, -n), y = n)) +
geom_bar(stat = "identity", fill = "#b6b6b6",color="#929292") +
labs(x = "Animal Model", y = "Number of studies") +
ylim(0, 320) +
common_theme+
facet_grid(. ~ item,scales = "free", labeller=labeller_row2)+
theme(
strip.text.x = element_text(hjust=0,size=12),
panel.spacing = unit(1.5, "lines"))
p3<-rbind(HERMES_INCLUDED %>% group_by(Tested.drug.2,status2) %>% count() %>% rename(drugs=1,status=2),
HERMES_INCLUDED %>% group_by(Tested.drug.s.,status) %>% count() %>% rename(drugs=1,status=2)) %>%
data.frame() %>%
group_by(drugs,status) %>%
summarise(n=sum(n)) %>%
mutate(across(everything(),~ gsub("NA",NA, .))) %>%
unique() %>%
drop_na()%>%
mutate(status=ifelse(status=="Marketed","Approved drugs","Failed drugs")) %>%
mutate(n=as.numeric(n),
drugs=case_when(
drugs=="Glatiramer acetate"~"GA",
drugs=="Dimethyl fumarate"~"DMF",
drugs=="Peginterferon beta-1a"~"PEG-IFN beta-1a",
drugs=="Interferon Beta 1"~"IFN beta-1",
drugs=="Monomethyl fumarate"~"MMF",
drugs=="Epigallocatechin gallate"~"EGCG",
TRUE~drugs
)) %>%
ggplot(aes(x = reorder(drugs, -n), y = n,fill=status,color=status)) +
geom_bar(stat = "identity") +
labs(x = "Tested Drugs", y ="Number ofstudies") +
common_theme+
scale_fill_manual(values=c("Approved drugs"="#6896ca","Failed drugs"="#ff7b74"))+
scale_color_manual(values=c("Approved drugs"="#567ca7","Failed drugs"="#d0645e"))+
theme(legend.title=element_blank())
figure_panel3<-grid.arrange(plot_row1,plot_row2,
p3+ggtitle(bquote(bold("E.")~"Tested drugs"))+
theme(legend.position = "bottom",
legend.text = element_text(size=13,color="gray20")),
ncol=1,heights=c(1,1,1.5))
# ggsave("Figure_panel1_border_try.png",figure_panel3,height = 29/2.5,width = 21/2.5)
ggsave("Figure2_paneldemo_final.png",figure_panel3,height = 29/2.5,width = 21/2.5)
panel_fig_FDA
ggsave("Figure3_timeline_final.png",panel_fig_FDA,height = 29/2.5,width = 21/2.5,bg = "white")
ggsave("Figure6_timeline_final.png",panel_fig_FDA,height = 29/2.5,width = 21/2.5,bg = "white")
ES_df_trial<-rbind(rbind(HERMES_INCLUDED %>% select(Tested.drug.s.,starts_with("EAE_1")) %>%  rename_with(~gsub("_1", "", .), contains("_1")) %>% rename(drug_name=1),
HERMES_INCLUDED %>% select(Tested.drug.2,starts_with("EAE_2")) %>%  rename_with(~gsub("_2", "", .), contains("_2"))%>% rename(drug_name=1),
HERMES_INCLUDED %>% select(Tested.drug.3,starts_with("EAE_3")) %>%  rename_with(~gsub("_3", "", .), contains("_3"))%>% rename(drug_name=1)) %>%  rename_with(~gsub("EAE_", "", .), contains("EAE_")) %>% mutate(item="EAE"),
rbind(HERMES_INCLUDED %>% select(Tested.drug.s.,starts_with("MRI_1")) %>%  rename_with(~gsub("_1", "", .), contains("_1")) %>% rename(drug_name=1),
HERMES_INCLUDED %>% select(Tested.drug.2,starts_with("MRI_2")) %>%  rename_with(~gsub("_2", "", .), contains("_2"))%>% rename(drug_name=1),
HERMES_INCLUDED %>% select(Tested.drug.3,starts_with("MRI_3")) %>%  rename_with(~gsub("_3", "", .), contains("_3"))%>% rename(drug_name=1),
HERMES_INCLUDED %>% select(Tested.drug.s.,starts_with("MRI_4")) %>%  rename_with(~gsub("_4", "", .), contains("_4"))%>% rename(drug_name=1))%>%  rename_with(~gsub("MRI_", "", .), contains("MRI_")) %>% mutate(item="MRI")) %>%
drop_na(!data_type) %>%
replace_na(list(data_type="mean,SEM")) %>%
mutate(var_measure=case_when(
grepl("SEM",data_type)~"SEM",
grepl("SD",data_type)~"SD",
TRUE~"SEM"
)) %>%
mutate(drug_var=ifelse(var_measure=="SEM",drug_var*sqrt(drug_n),drug_var),
con_var=ifelse(var_measure=="SEM",con_var*sqrt(con_n),con_var)) %>%
mutate(
escalc( "SMD",
m2i = drug_mean,
n2i = drug_n,
sd2i = drug_var,
m1i = con_mean,
n1i = con_n,
sd1i = con_var,
data = .
)) %>%
rename(Name=drug_name) %>%
merge(.,drug_info_df,by="Name") %>%
mutate(drug_status=ifelse(drug_status=="Marketed","1Marketed","2Failed")) %>%
group_by(item,drug_status,Name) %>%
mutate(rank=cur_group_id())
ES_df_trial2<-ES_df_trial %>%
arrange(rank) %>%
# select(item,drug_status,Name,rank) %>%
ungroup() %>%
group_split(item,drug_status) %>%
map_dfr(~ .x %>% add_row(drug_status = NA, .after = Inf)) %>%
ungroup() %>%
mutate(rank=rank*2) %>%
mutate(rank = ifelse(is.na(rank), lag(rank) + 1, rank)) %>%
fill(drug_status,item)%>%
mutate(Name=case_when(
is.na(Name)&drug_status=="2Failed"~"Median ES failed drugs",
is.na(Name)&drug_status=="1Marketed"~"Median ES marketed drugs",
TRUE~Name
)) %>%
mutate(yi=case_when(#median
is.na(yi)&item=="EAE"&drug_status=="2Failed"~median(ES_df_trial$yi[ES_df_trial$drug_status=="2Failed"&ES_df_trial$item=="EAE"],na.rm=T),
is.na(yi)&item=="EAE"&drug_status=="1Marketed"~median(ES_df_trial$yi[ES_df_trial$drug_status=="1Marketed"&ES_df_trial$item=="EAE"],na.rm=T),
is.na(yi)&item=="MRI"&drug_status=="2Failed"~median(ES_df_trial$yi[ES_df_trial$drug_status=="2Failed"&ES_df_trial$item=="MRI"],na.rm=T),
is.na(yi)&item=="MRI"&drug_status=="1Marketed"~median(ES_df_trial$yi[ES_df_trial$drug_status=="1Marketed"&ES_df_trial$item=="MRI"],na.rm=T),
TRUE~yi
)) %>%
mutate(lower_CI=case_when(#lowerCI
item=="EAE"&drug_status=="2Failed"&Name=="Median ES failed drugs" ~quantile(ES_df_trial$yi[ES_df_trial$drug_status=="2Failed"&ES_df_trial$item=="EAE"],na.rm=T)[2],
item=="EAE"&drug_status=="1Marketed"&Name=="Median ES marketed drugs" ~quantile(ES_df_trial$yi[ES_df_trial$drug_status=="1Marketed"&ES_df_trial$item=="EAE"],na.rm=T)[2],
item=="MRI"&drug_status=="2Failed"&Name=="Median ES failed drugs" ~quantile(ES_df_trial$yi[ES_df_trial$drug_status=="2Failed"&ES_df_trial$item=="MRI"],na.rm=T)[2],
item=="MRI"&drug_status=="1Marketed"&Name=="Median ES marketed drugs" ~quantile(ES_df_trial$yi[ES_df_trial$drug_status=="1Marketed"&ES_df_trial$item=="MRI"],na.rm=T)[2],
TRUE~NA
)) %>%
mutate(upper_CI=case_when(#upperCI
item=="EAE"&drug_status=="2Failed"&Name=="Median ES failed drugs" ~quantile(ES_df_trial$yi[ES_df_trial$drug_status=="2Failed"&ES_df_trial$item=="EAE"],na.rm=T)[4],
item=="EAE"&drug_status=="1Marketed"&Name=="Median ES marketed drugs" ~quantile(ES_df_trial$yi[ES_df_trial$drug_status=="1Marketed"&ES_df_trial$item=="EAE"],na.rm=T)[4],
item=="MRI"&drug_status=="2Failed"&Name=="Median ES failed drugs" ~quantile(ES_df_trial$yi[ES_df_trial$drug_status=="2Failed"&ES_df_trial$item=="MRI"],na.rm=T)[4],
item=="MRI"&drug_status=="1Marketed"&Name=="Median ES marketed drugs" ~quantile(ES_df_trial$yi[ES_df_trial$drug_status=="1Marketed"&ES_df_trial$item=="MRI"],na.rm=T)[4],
TRUE~NA
)) %>%
mutate(color=ifelse(is.na(drug_mean),"overall",drug_status)) %>%
ungroup() %>%
group_by(as.factor(rank)) %>%
mutate(rank2=cur_group_id()) %>%
mutate(Name=case_when(
Name=="Interferon Beta 1"~"Interferon beta-1",
Name=="Median ES marketed drugs"~"Median ES approved drugs",
TRUE~Name)) %>%
mutate(color=case_when(
color=="1Marketed"~"Approved",
color=="2Failed"~"Failed",
TRUE~color))
MRI_EAE_ES_plot<-ES_df_trial2 %>%
ggplot(aes(y = rank2, x = yi))+
geom_segment(aes(y=rank2,yend=rank2,x=-3.5,xend=30),color="#f1f1f1",linewidth=0.4)+
geom_point(aes(fill=color,color=color,shape=color,alpha=color,size=color))+
geom_segment(aes(y=rank2,yend=rank2,x=upper_CI,xend=lower_CI),color="#222222")+
geom_label(data = . %>% filter(grepl("Median",Name)),aes(label=Name,x=-4),label.size = NA,hjust=1,fontface="bold")+
geom_label(data = . %>% filter(!(grepl("Median",Name))),aes(label=Name,x=-4),label.size = NA,hjust=1)+
labs(x = "Tested Drugs", y = "Effect Size") +
theme_minimal()+
theme(axis.title = element_blank(),
axis.text.x = element_text(size=14),
axis.text.y = element_blank(),
panel.grid.major.y =element_blank(),
panel.grid.minor.y =element_blank(),
strip.background = element_rect(fill="#e8eae7",color="#cbccca"),
panel.grid.minor.x =element_blank(),
legend.title = element_blank(),
strip.text = element_text(size=14),
legend.text = element_text(size=12),
legend.position = "bottom")+
scale_color_manual(values=c("Approved"="#567ca7", "Failed"="#d0645e","overall"="#222222"),breaks=c("Approved","Failed"))+
scale_fill_manual(values=c("Approved"="#6896ca", "Failed"="#ff7b74","overall"="#222222"),breaks=c("Approved","Failed"))+
scale_alpha_manual(values=c("Approved"=0.75, "Failed"=0.75,"overall"=1),breaks=c("Approved","Failed"))+
scale_shape_manual(values=c("Approved"=21, "Failed"=21,"overall"=23),breaks=c("Approved","Failed"))+
scale_size_manual(values=c("Approved"=4, "Failed"=4,"overall"=2),breaks=c("Approved","Failed"))+
scale_y_reverse()+
scale_x_continuous(breaks=c(0,10,20))+
facet_wrap(.~item,ncol=1,scales = "free_y",strip.position="right")+
force_panelsizes(rows = c(1,0.30)) +
coord_cartesian(xlim=c(-20,NA))
ggsave("Figure4_ES_final.png",MRI_EAE_ES_plot,height = 29/3,width = 21/3,bg = "white")
MRI_EAE_ES_plot<-ES_df_trial2 %>%
ggplot(aes(y = rank2, x = yi))+
geom_vline(xintercept = 0,linetype="dashed")
MRI_EAE_ES_plot
MRI_EAE_ES_plot<-ES_df_trial2 %>%
ggplot(aes(y = rank2, x = yi))+
geom_vline(xintercept = 0,linetype="dashed") %>%
geom_segment(aes(y=rank2,yend=rank2,x=-3.5,xend=30),color="#f1f1f1",linewidth=0.4)+
geom_point(aes(fill=color,color=color,shape=color,alpha=color,size=color))+
geom_segment(aes(y=rank2,yend=rank2,x=upper_CI,xend=lower_CI),color="#222222")+
geom_label(data = . %>% filter(grepl("Median",Name)),aes(label=Name,x=-4),label.size = NA,hjust=1,fontface="bold")+
geom_label(data = . %>% filter(!(grepl("Median",Name))),aes(label=Name,x=-4),label.size = NA,hjust=1)+
labs(x = "Tested Drugs", y = "Effect Size") +
theme_minimal()+
theme(axis.title = element_blank(),
axis.text.x = element_text(size=14),
axis.text.y = element_blank(),
panel.grid.major.y =element_blank(),
panel.grid.minor.y =element_blank(),
strip.background = element_rect(fill="#e8eae7",color="#cbccca"),
panel.grid.minor.x =element_blank(),
legend.title = element_blank(),
strip.text = element_text(size=14),
legend.text = element_text(size=12),
legend.position = "bottom")+
scale_color_manual(values=c("Approved"="#567ca7", "Failed"="#d0645e","overall"="#222222"),breaks=c("Approved","Failed"))+
scale_fill_manual(values=c("Approved"="#6896ca", "Failed"="#ff7b74","overall"="#222222"),breaks=c("Approved","Failed"))+
scale_alpha_manual(values=c("Approved"=0.75, "Failed"=0.75,"overall"=1),breaks=c("Approved","Failed"))+
scale_shape_manual(values=c("Approved"=21, "Failed"=21,"overall"=23),breaks=c("Approved","Failed"))+
scale_size_manual(values=c("Approved"=4, "Failed"=4,"overall"=2),breaks=c("Approved","Failed"))+
scale_y_reverse()+
scale_x_continuous(breaks=c(0,10,20))+
facet_wrap(.~item,ncol=1,scales = "free_y",strip.position="right")+
force_panelsizes(rows = c(1,0.30)) +
coord_cartesian(xlim=c(-20,NA))
MRI_EAE_ES_plot<-ES_df_trial2 %>%
ggplot(aes(y = rank2, x = yi))+
geom_vline(xintercept = 0,linetype="dashed") +
geom_segment(aes(y=rank2,yend=rank2,x=-3.5,xend=30),color="#f1f1f1",linewidth=0.4)+
geom_point(aes(fill=color,color=color,shape=color,alpha=color,size=color))+
geom_segment(aes(y=rank2,yend=rank2,x=upper_CI,xend=lower_CI),color="#222222")+
geom_label(data = . %>% filter(grepl("Median",Name)),aes(label=Name,x=-4),label.size = NA,hjust=1,fontface="bold")+
geom_label(data = . %>% filter(!(grepl("Median",Name))),aes(label=Name,x=-4),label.size = NA,hjust=1)+
labs(x = "Tested Drugs", y = "Effect Size") +
theme_minimal()+
theme(axis.title = element_blank(),
axis.text.x = element_text(size=14),
axis.text.y = element_blank(),
panel.grid.major.y =element_blank(),
panel.grid.minor.y =element_blank(),
strip.background = element_rect(fill="#e8eae7",color="#cbccca"),
panel.grid.minor.x =element_blank(),
legend.title = element_blank(),
strip.text = element_text(size=14),
legend.text = element_text(size=12),
legend.position = "bottom")+
scale_color_manual(values=c("Approved"="#567ca7", "Failed"="#d0645e","overall"="#222222"),breaks=c("Approved","Failed"))+
scale_fill_manual(values=c("Approved"="#6896ca", "Failed"="#ff7b74","overall"="#222222"),breaks=c("Approved","Failed"))+
scale_alpha_manual(values=c("Approved"=0.75, "Failed"=0.75,"overall"=1),breaks=c("Approved","Failed"))+
scale_shape_manual(values=c("Approved"=21, "Failed"=21,"overall"=23),breaks=c("Approved","Failed"))+
scale_size_manual(values=c("Approved"=4, "Failed"=4,"overall"=2),breaks=c("Approved","Failed"))+
scale_y_reverse()+
scale_x_continuous(breaks=c(0,10,20))+
facet_wrap(.~item,ncol=1,scales = "free_y",strip.position="right")+
force_panelsizes(rows = c(1,0.30)) +
coord_cartesian(xlim=c(-20,NA))
ggsave("Figure4_ES_final.png",MRI_EAE_ES_plot,height = 29/3,width = 21/3,bg = "white")
MRI_EAE_ES_plot<-ES_df_trial2 %>%
ggplot(aes(y = rank2, x = yi))+
geom_segment(aes(y=rank2,yend=rank2,x=-3.5,xend=30),color="#f1f1f1",linewidth=0.4)+
geom_vline(xintercept = 0,linetype="dashed",color="gray20",linewidth=0.5) +
geom_point(aes(fill=color,color=color,shape=color,alpha=color,size=color))+
geom_segment(aes(y=rank2,yend=rank2,x=upper_CI,xend=lower_CI),color="#222222")+
geom_label(data = . %>% filter(grepl("Median",Name)),aes(label=Name,x=-4),label.size = NA,hjust=1,fontface="bold")+
geom_label(data = . %>% filter(!(grepl("Median",Name))),aes(label=Name,x=-4),label.size = NA,hjust=1)+
labs(x = "Tested Drugs", y = "Effect Size") +
theme_minimal()+
theme(axis.title = element_blank(),
axis.text.x = element_text(size=14),
axis.text.y = element_blank(),
panel.grid.major.y =element_blank(),
panel.grid.minor.y =element_blank(),
strip.background = element_rect(fill="#e8eae7",color="#cbccca"),
panel.grid.minor.x =element_blank(),
legend.title = element_blank(),
strip.text = element_text(size=14),
legend.text = element_text(size=12),
legend.position = "bottom")+
scale_color_manual(values=c("Approved"="#567ca7", "Failed"="#d0645e","overall"="#222222"),breaks=c("Approved","Failed"))+
scale_fill_manual(values=c("Approved"="#6896ca", "Failed"="#ff7b74","overall"="#222222"),breaks=c("Approved","Failed"))+
scale_alpha_manual(values=c("Approved"=0.75, "Failed"=0.75,"overall"=1),breaks=c("Approved","Failed"))+
scale_shape_manual(values=c("Approved"=21, "Failed"=21,"overall"=23),breaks=c("Approved","Failed"))+
scale_size_manual(values=c("Approved"=4, "Failed"=4,"overall"=2),breaks=c("Approved","Failed"))+
scale_y_reverse()+
scale_x_continuous(breaks=c(0,10,20))+
facet_wrap(.~item,ncol=1,scales = "free_y",strip.position="right")+
force_panelsizes(rows = c(1,0.30)) +
coord_cartesian(xlim=c(-20,NA))
ggsave("Figure4_ES_final.png",MRI_EAE_ES_plot,height = 29/3,width = 21/3,bg = "white")
